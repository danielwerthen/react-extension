{"version":3,"file":"index.module.js","sources":["../src/index.ts"],"sourcesContent":["let reactModule: any;\nif (process.env.NODE_ENV === \"production\") {\n  reactModule = require(\"react/cjs/react.production.min.js\");\n} else {\n  reactModule = require(\"react/cjs/react.development.js\");\n}\n\nexport type ExtensionFunction = (\n  tagName: string,\n  props: { [key: string]: any }\n) => { [key: string]: any };\n\nconst CONTEXT_KEY = Symbol.for(\"@dwerthen/react-extension/Context\");\nconst globalSymbols = Object.getOwnPropertySymbols(global);\nconst hasContext = globalSymbols.indexOf(CONTEXT_KEY) > -1;\n\nif (!hasContext) {\n  (global as any)[CONTEXT_KEY] = reactModule.createContext();\n}\n\nexport const extensionContext: React.Context<ExtensionFunction> = (global as any)[\n  CONTEXT_KEY\n];\n\nexport const originalCreateElement = reactModule.createElement;\n\nconst cache: { [key: string]: React.FunctionComponent } = {};\nfunction _extendTag(tagName: string): React.FunctionComponent {\n  const Component = reactModule.forwardRef(\n    (props: { [key: string]: any }, ref: unknown) => {\n      const extender = reactModule.useContext(extensionContext);\n      const newProps =\n        typeof extender === \"function\" ? extender(tagName, props) : props;\n      return originalCreateElement(tagName, { ...newProps, ref });\n    }\n  );\n  if (process.env.NODE_ENV !== \"production\") {\n    Component.displayName = tagName;\n  }\n  return Component;\n}\n\nfunction extendTag(tagName: string): React.FunctionComponent {\n  return cache[tagName] || (cache[tagName] = _extendTag(tagName));\n}\n\nexport function extendedCreateElement(tag: any, props: any, ...children: any) {\n  const newTag = typeof tag === \"string\" ? extendTag(tag) : tag;\n  return originalCreateElement(newTag, props, ...children);\n}\n\nreactModule.createElement = extendedCreateElement;\n\nexport const ExtensionProvider = extensionContext.Provider;\n"],"names":["let","reactModule","process","env","NODE_ENV","require","const","CONTEXT_KEY","Symbol","for","Object","getOwnPropertySymbols","global","indexOf","createContext","extensionContext","originalCreateElement","createElement","cache","extendedCreateElement","tag","props","tagName","newTag","Component","forwardRef","ref","extender","useContext","newProps","displayName","_extendTag","children","ExtensionProvider","Provider"],"mappings":"AAAAA,IAAIC,EAEFA,EAD2B,eAAzBC,QAAQC,IAAIC,SACAC,QAAQ,qCAERA,QAAQ,kCAQxBC,IAAMC,EAAcC,OAAOC,IAAI,qCACTC,OAAOC,sBAAsBC,QAClBC,QAAQN,IAAgB,IAGtDK,OAAeL,GAAeN,EAAYa,qBAGhCC,EAAsDH,OACjEL,GAGWS,EAAwBf,EAAYgB,cAE3CC,EAAoD,YAoB1CC,EAAsBC,EAAUC,qEAJ7BC,EAKXC,EAAwB,iBAARH,EAJfF,EADUI,EAKkCF,KAJzBF,EAAMI,GAhBlC,SAAoBA,OACZE,EAAYvB,EAAYwB,oBAC3BJ,EAA+BK,OACxBC,EAAW1B,EAAY2B,WAAWb,GAClCc,EACgB,mBAAbF,EAA0BA,EAASL,EAASD,GAASA,SACvDL,EAAsBM,EAASZ,iBAAKmB,OAAUH,aAG5B,eAAzBxB,QAAQC,IAAIC,WACdoB,EAAUM,YAAcR,GAEnBE,EAIoCO,CAAWT,IAIIF,SACnDJ,gBAAsBO,EAAQF,UAAUW,IAGjD/B,EAAYgB,cAAgBE,MAEfc,EAAoBlB,EAAiBmB"}